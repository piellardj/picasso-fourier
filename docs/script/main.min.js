!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i={PRESET:"preset-picker-id",MODE:"mode-picker-id",SPEED:"speed-range-id",PERSISTENCE:"persistence-checkbox-id",CLOSE_LOOP:"close-loop-checkbox-id",REPEAT:"loop-checkbox-id",RESET:"reset-button-id",DISPLAY_CIRCLES:"circles-checkbox-id",DISPLAY_SEGMENTS:"segments-checkbox-id",DISPLAY_CURVE:"curve-checkbox-id",DISPLAY_ORIGINAL_CURVE:"original-curve-checkbox-id",ORDER:"order-range-id"};function a(e){for(var t=0,r=e;t<r.length;t++){(0,r[t])()}}!function(e){e.INSTANT="0",e.PROGRESSIVE="1"}(n||(n={}));var s,o,c={clear:[],redraw:[],speedChange:[],presetChange:[]};function u(e){var t=s;(s=e)!==t&&a(c.presetChange)}function h(e){if(1===e.length){var t=e[0];if(t!==o){var r=(o=t)===n.INSTANT;Controls.setVisibility(i.DISPLAY_CIRCLES,r),Controls.setVisibility(i.DISPLAY_SEGMENTS,r),Controls.setVisibility(i.DISPLAY_CURVE,r),a(c.clear)}}}Picker.addObserver(i.PRESET,u),u(Picker.getValue(i.PRESET)),h(Tabs.getValues(i.MODE)),Tabs.addObserver(i.MODE,h);var l=Range.getValue(i.SPEED);Range.addObserver(i.SPEED,(function(e){var t=l;l=e;for(var r=0,n=c.speedChange;r<n.length;r++){(0,n[r])(t)}}));var p=Checkbox.isChecked(i.PERSISTENCE);Checkbox.addObserver(i.PERSISTENCE,(function(e){p=e}));var f=Checkbox.isChecked(i.CLOSE_LOOP);Checkbox.addObserver(i.CLOSE_LOOP,(function(e){f=e,o===n.PROGRESSIVE&&a(c.clear)}));var d=Checkbox.isChecked(i.REPEAT);Checkbox.addObserver(i.REPEAT,(function(e){d=e})),Button.addObserver(i.RESET,(function(){return a(c.clear)}));var v=Checkbox.isChecked(i.DISPLAY_CIRCLES);Checkbox.addObserver(i.DISPLAY_CIRCLES,(function(e){v=e,a(c.redraw)}));var g=Checkbox.isChecked(i.DISPLAY_SEGMENTS);Checkbox.addObserver(i.DISPLAY_SEGMENTS,(function(e){g=e,a(c.redraw)}));var b=Checkbox.isChecked(i.DISPLAY_CURVE);Checkbox.addObserver(i.DISPLAY_CURVE,(function(e){b=e,a(c.redraw)}));var P=Checkbox.isChecked(i.DISPLAY_ORIGINAL_CURVE);Checkbox.addObserver(i.DISPLAY_ORIGINAL_CURVE,(function(e){P=e,a(c.redraw)}));var m=Range.getValue(i.ORDER);Range.addObserver(i.ORDER,(function(e){m=e,a(c.clear)}));var C=function(){function e(){}return Object.defineProperty(e,"preset",{get:function(){return s},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isProgressiveMode",{get:function(){return o===n.PROGRESSIVE},enumerable:!0,configurable:!0}),Object.defineProperty(e,"speed",{get:function(){return this.isProgressiveMode?.1*l:l},enumerable:!0,configurable:!0}),Object.defineProperty(e,"persistence",{get:function(){return p},enumerable:!0,configurable:!0}),Object.defineProperty(e,"closeLoop",{get:function(){return f},enumerable:!0,configurable:!0}),Object.defineProperty(e,"repeat",{get:function(){return d},enumerable:!0,configurable:!0}),Object.defineProperty(e,"displayCircles",{get:function(){return o===n.INSTANT&&v},enumerable:!0,configurable:!0}),Object.defineProperty(e,"displaySegments",{get:function(){return o===n.INSTANT&&g},enumerable:!0,configurable:!0}),Object.defineProperty(e,"displayCurve",{get:function(){return o===n.INSTANT&&b},enumerable:!0,configurable:!0}),Object.defineProperty(e,"displayOriginalCurve",{get:function(){return P},enumerable:!0,configurable:!0}),Object.defineProperty(e,"order",{get:function(){return m},enumerable:!0,configurable:!0}),Object.defineProperty(e,"integrationPrecision",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"curvePrecision",{get:function(){return.5},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clearObservers",{get:function(){return c.clear},enumerable:!0,configurable:!0}),Object.defineProperty(e,"redrawObservers",{get:function(){return c.redraw},enumerable:!0,configurable:!0}),Object.defineProperty(e,"speedChangeObservers",{get:function(){return c.speedChange},enumerable:!0,configurable:!0}),Object.defineProperty(e,"presetObservers",{get:function(){return c.presetChange},enumerable:!0,configurable:!0}),e}();t.Parameters=C},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.interpolate=function(e,t,r){return{x:e.x*(1-r)+t.x*r,y:e.y*(1-r)+t.y*r}},t.distance=function(e,t){var r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)},t.equals=function(e,t){return e.x===t.x&&e.y===t.y}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=!0;t.setEnabled=function(e){n=e},t.message=function(e){n&&console.log(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.start=performance.now()}return Object.defineProperty(e.prototype,"milliseconds",{get:function(){return Math.ceil(performance.now()-this.start)},enumerable:!0,configurable:!0}),e}();t.StopWatch=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(6),a=r(7),s=r(0),o=r(9);function c(e){e=Math.round(10*e)/10,Canvas.setIndicatorText("fourier-order",e.toLocaleString())}!function(){var e=new n.Canvas2D("canvas"),t=e.context;t.lineWidth=1;var r=null,u=null,h=new i.Clock,l=!0;s.Parameters.clearObservers.push((function(){return l=!0}));var p=!0;s.Parameters.redrawObservers.push((function(){return p=!0}));var f=2e3;function d(){r=null,u=null;var e=Canvas.getSize();Canvas.showLoader(!0),o.Presets.getPreset(s.Parameters.preset,e,(function(e){r=new a.LineDrawing(e),u=r.computeFourierSeries(300),l=!0,h.reset(),Canvas.showLoader(!1)}))}s.Parameters.presetObservers.push(d),Canvas.Observers.canvasResize.push(d),d(),requestAnimationFrame((function n(){if(null!==r&&null!==u){var i=h.current/f,a=s.Parameters.closeLoop?1:r.originalPathDuration,o=i>=a;if(!o&&h.isPaused&&h.resume(),i=Math.min(i,a),o&&(s.Parameters.repeat?l=!0:h.pause()),l&&(l=!1,h.reset(),u.resetCurve(),i=0,o=!1,c(s.Parameters.order),e.clear()),p){if(e.adjustSize(),s.Parameters.persistence||e.clear(),s.Parameters.displayOriginalCurve){t.strokeStyle="rgb(0,128,0)";var d=t.lineWidth;t.lineWidth=2,r.draw(t,s.Parameters.isProgressiveMode?a:i),t.lineWidth=d}if(s.Parameters.displayCircles&&(t.strokeStyle=s.Parameters.persistence?"rgba(255,255,255,0.01)":"rgba(255,255,255,0.3)",u.drawCircles(t,s.Parameters.order,i)),s.Parameters.displayCurve&&(t.strokeStyle="white",u.drawCurve(t,s.Parameters.order,i)),s.Parameters.displaySegments&&(t.strokeStyle=s.Parameters.persistence?"rgba(255,0,0,0.01)":"red",u.drawPathToPoint(t,s.Parameters.order,i)),s.Parameters.isProgressiveMode){t.strokeStyle=s.Parameters.persistence?"rgba(255,255,255,0.01)":"white";var v=s.Parameters.order*i/a;u.drawCurvePartialOrder(t,v,a),c(v)}}p=!o}requestAnimationFrame(n)}))}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.canvas=document.getElementById(e),this.context=this.canvas.getContext("2d")}return e.prototype.adjustSize=function(){this.canvas.width===this.canvas.clientWidth&&this.canvas.height===this.canvas.clientHeight||(this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight)},e.prototype.clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e}();t.Canvas2D=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){function e(){var e=this;this.speed=n.Parameters.speed,this.paused=!1,this.lastCheckpoint={clockTime:0,realTime:0},n.Parameters.speedChangeObservers.push((function(){return e.setSpeed(n.Parameters.speed)})),this.reset()}return e.prototype.reset=function(){this.paused=!1,this.lastCheckpoint.clockTime=0,this.lastCheckpoint.realTime=performance.now(),this.setSpeed(n.Parameters.speed)},e.prototype.setSpeed=function(e){this.createCheckpoint(),this.speed=e},e.prototype.pause=function(){this.paused||(this.createCheckpoint(),this.paused=!0)},e.prototype.resume=function(){this.paused&&(this.createCheckpoint(),this.paused=!1)},Object.defineProperty(e.prototype,"isPaused",{get:function(){return this.paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"current",{get:function(){return this.paused?this.lastCheckpoint.clockTime:this.lastCheckpoint.clockTime+this.speed*(performance.now()-this.lastCheckpoint.realTime)},enumerable:!0,configurable:!0}),e.prototype.createCheckpoint=function(){this.lastCheckpoint.clockTime=this.current,this.lastCheckpoint.realTime=performance.now()},e}();t.Clock=i},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=r(8),a=n(r(2)),s=r(0),o=r(1),c=r(3),u=function(){function e(e){this.points=e;for(var t=0,r=0;r<this.points.length-1;r++)t+=o.distance(this.points[r],this.points[r+1]);var n=t,i=this.points[0],a=this.points[this.points.length-1];o.equals(i,a)||(n+=o.distance(a,i),this.points.push({x:i.x,y:i.y})),this.pathLength=n,this.originalPathDuration=t/n}return e.prototype.draw=function(e,t){e.beginPath(),e.moveTo(this.points[0].x,this.points[0].y);var r,n=t*this.pathLength,i=0;for(r=0;r<this.points.length-1;r++){var a=this.points[r],s=this.points[r+1],c=o.distance(a,s);if(!(i+c<n)){var u=(n-i)/c,h=o.interpolate(a,s,u);e.lineTo(h.x,h.y),i+=o.distance(a,h);break}i+=c,e.lineTo(s.x,s.y)}e.stroke(),e.closePath()},e.prototype.computeFourierSeries=function(e){for(var t=new c.StopWatch,r=Math.ceil(s.Parameters.integrationPrecision*this.pathLength),n=this.pathLength/r,u=1/r,h=[],l=0,p=0,f=0;f<r;f++)for(var d=(f+.5)*u,v=(f+.5)*n,g=p;g<this.points.length-1;g++){var b=this.points[g],P=this.points[g+1],m=o.distance(b,P);if(!(l+m<v)){var C=(v-l)/m,y=o.interpolate(b,P,C);h.push({x:y.x,y:y.y,two_pi_t:2*Math.PI*d});break}l+=m,p=g+1}for(var S=[],O=0;O<2*e+1;O++){var E=Math.floor((O+1)/2);O>0&&O%2==0&&(E*=-1);for(var M=0,k=0,x=0,_=h;x<_.length;x++){var T=_[x],w=E*T.two_pi_t,L=Math.cos(w),R=Math.sin(w);M+=u*(T.x*L+T.y*R),k+=u*(T.y*L-T.x*R)}S.push({magnitude:Math.sqrt(M*M+k*k),phase:Math.atan2(k,M),n:E})}return a.message("Computed "+e+" Fourier coefficient with "+r+" integration steps in "+t.milliseconds+" ms."),new i.FourierSeries(S,this.pathLength)},e}();t.LineDrawing=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),a=2*Math.PI,s=function(){function e(e,t){if(0===e.length)throw new Error("Fourier series must have at least one coefficient.");e.sort((function(e,t){var r=Math.abs(e.n),n=Math.abs(t.n);return r!==n?r-n:t.n-e.n})),this.coefficients=e,this.partialCurve=[],this.curveStepSize=1/(n.Parameters.curvePrecision*t)}return e.prototype.resetCurve=function(){this.partialCurve=[]},e.prototype.drawCurve=function(e,t,r){this.completeCurve(t,r);var n=r/this.curveStepSize,a=Math.floor(n);e.beginPath(),e.moveTo(this.partialCurve[0].x,this.partialCurve[0].y);for(var s=1;s<=a;s++)e.lineTo(this.partialCurve[s].x,this.partialCurve[s].y);var o=n%1,c=this.partialCurve[a],u=this.partialCurve[a+1],h=i.interpolate(c,u,o);e.lineTo(h.x,h.y),e.stroke(),e.closePath()},e.prototype.drawCurvePartialOrder=function(e,t,r){var n=(t=Math.min(t,.5*(this.coefficients.length-1)-.001))%1;this.completeCurve(t,r);var i=this.getCoefficients(Math.floor(t)+1,Math.floor(t)+1);e.beginPath();for(var s=r/this.curveStepSize,o=0;o<s;o++){for(var c=o*this.curveStepSize,u=a*c,h=this.partialCurve[o].x,l=this.partialCurve[o].y,p=0,f=i;p<f.length;p++){var d=f[p],v=u*d.n;h+=n*d.magnitude*Math.cos(v+d.phase),l+=n*d.magnitude*Math.sin(v+d.phase)}0===o?e.moveTo(h,l):e.lineTo(h,l)}e.stroke(),e.closePath()},e.prototype.drawPathToPoint=function(e,t,r){var n=this.getCoefficients(0,0)[0],i=n.magnitude*Math.cos(n.phase),s=n.magnitude*Math.sin(n.phase),o=a*r;e.beginPath(),e.moveTo(i,s);for(var c=0,u=this.getCoefficients(1,t);c<u.length;c++){var h=u[c],l=o*h.n;i+=h.magnitude*Math.cos(l+h.phase),s+=h.magnitude*Math.sin(l+h.phase),e.lineTo(i,s)}e.stroke(),e.closePath()},e.prototype.drawCircles=function(e,t,r){var n=0,i=0,s=this.getCoefficients(0,t);if(!(s.length<2))for(var o,c,u,h=a*r,l=0,p=s;l<p.length;l++){var f=p[l];0!==f.n&&1!==f.n&&(o=n,c=i,(u=f.magnitude)>.5&&(e.beginPath(),e.arc(o,c,u,0,a),e.closePath(),e.stroke()));var d=h*f.n;n+=f.magnitude*Math.cos(d+f.phase),i+=f.magnitude*Math.sin(d+f.phase)}},e.prototype.completeCurve=function(e,t){if((e=Math.floor(e))<this.partialCurveOrder&&this.resetCurve(),e>this.partialCurveOrder)for(var r=this.getCoefficients(this.partialCurveOrder+1,e),n=0;n<this.partialCurve.length;n++)for(var i=n*this.curveStepSize,s=a*i,o=this.partialCurve[n],c=0,u=r;c<u.length;c++){var h=u[c],l=s*h.n;o.x+=h.magnitude*Math.cos(l+h.phase),o.y+=h.magnitude*Math.sin(l+h.phase)}var p,f=t/this.curveStepSize,d=Math.floor(f);for(n=this.partialCurve.length;n<=d+1;n++)p=this.computePoint(e,n*this.curveStepSize),this.partialCurve.push(p);this.partialCurveOrder=e},e.prototype.computePoint=function(e,t){for(var r=0,n=0,i=0,s=this.getCoefficients(0,e);i<s.length;i++){var o=s[i],c=a*o.n*t;r+=o.magnitude*Math.cos(c+o.phase),n+=o.magnitude*Math.sin(c+o.phase)}return{x:r,y:n}},e.prototype.getCoefficients=function(e,t){e=Math.min(e,t);var r=Math.max(0,2*e-1),n=Math.min(this.coefficients.length,2*t+1);return this.coefficients.slice(r,n)},e}();t.FourierSeries=s},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(r(2)),s=r(3);!function(e){e.ARLEQUIN="arlequin",e.BULL="bull",e.CAMEL="camel",e.DOG="dog",e.DOVE="dove",e.FLAMINGO="flamingo",e.HORSE="horse",e.MOUSE="mouse",e.WOMAN1="woman1",e.WOMAN2="woman2"}(i||(i={})),t.EPreset=i;var o=512,c=function(){function e(){}return e.getPreset=function(t,r,n){var i=new s.StopWatch,c=!1;function u(e){for(var s=Math.min(r[0]/o,r[1]/o),u=.5*(r[0]-o*s),h=.5*(r[1]-o*s),l=[],p=0,f=e;p<f.length;p++){var d=f[p];l.push({x:d.x*s+u,y:d.y*s+h})}c?a.message("Retrieved preset '"+t+"' from cache in "+i.milliseconds+" ms"):a.message("Downloaded preset '"+t+"' in "+i.milliseconds+" ms."),n(l)}if(void 0===e.cache)e.cache={};else if(void 0!==e.cache[t])return c=!0,void u(e.cache[t]);var h=new XMLHttpRequest;h.addEventListener("readystatechange",(function(){if(h.readyState===XMLHttpRequest.DONE&&200===h.status){var r=e.tryParsePointsArray(h.responseText);null!==r&&(e.cache[t]=r,u(e.cache[t]))}})),h.open("GET","resources/"+t+".txt"),h.send()},e.tryParsePointsArray=function(e){if(!e)return null;for(var t=new s.StopWatch,r=[],n=0,i=e.split("\n");n<i.length;n++){var o=i[n].split(" ");if(2!==o.length)return null;r.push({x:+o[0],y:+o[1]})}return r.length<=1?null:(a.message("Parsed preset in "+t.milliseconds+" ms."),r)},e}();t.Presets=c}]);
//# sourceMappingURL=main.min.js.map