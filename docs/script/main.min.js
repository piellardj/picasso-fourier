!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="preset-picker-id",i="speed-range-id",a="persistence-checkbox-id",o="close-loop-checkbox-id",s="loop-checkbox-id",c="reset-button-id",u="circles-checkbox-id",l="segments-checkbox-id",h="curve-checkbox-id",f="original-curve-checkbox-id",p="order-range-id";function d(e){for(var t=0,r=e;t<r.length;t++){(0,r[t])()}}var v,b={clear:[],redraw:[],speedChange:[],presetChange:[]};function g(e){var t=v;(v=e)!==t&&d(b.presetChange)}Picker.addObserver(n,g),g(Picker.getValue(n));var m=Range.getValue(i);Range.addObserver(i,(function(e){var t=m;m=e;for(var r=0,n=b.speedChange;r<n.length;r++){(0,n[r])(t)}}));var y=Checkbox.isChecked(a);Checkbox.addObserver(a,(function(e){y=e}));var P=Checkbox.isChecked(o);Checkbox.addObserver(o,(function(e){P=e,d(b.clear)}));var O=Checkbox.isChecked(s);Checkbox.addObserver(s,(function(e){O=e})),Button.addObserver(c,(function(){return d(b.clear)}));var C=Checkbox.isChecked(u);Checkbox.addObserver(u,(function(e){C=e,d(b.redraw)}));var x=Checkbox.isChecked(l);Checkbox.addObserver(l,(function(e){x=e,d(b.redraw)}));var k=Checkbox.isChecked(h);Checkbox.addObserver(h,(function(e){k=e,d(b.redraw)}));var w=Checkbox.isChecked(f);Checkbox.addObserver(f,(function(e){w=e,d(b.redraw)}));var M=Range.getValue(p);Range.addObserver(p,(function(e){M=e,d(b.clear)}));var j=function(){function e(){}return Object.defineProperty(e,"preset",{get:function(){return v},enumerable:!0,configurable:!0}),Object.defineProperty(e,"speed",{get:function(){return m},enumerable:!0,configurable:!0}),Object.defineProperty(e,"persistence",{get:function(){return y},enumerable:!0,configurable:!0}),Object.defineProperty(e,"closeLoop",{get:function(){return P},enumerable:!0,configurable:!0}),Object.defineProperty(e,"repeat",{get:function(){return O},enumerable:!0,configurable:!0}),Object.defineProperty(e,"displayCircles",{get:function(){return C},enumerable:!0,configurable:!0}),Object.defineProperty(e,"displaySegments",{get:function(){return x},enumerable:!0,configurable:!0}),Object.defineProperty(e,"displayCurve",{get:function(){return k},enumerable:!0,configurable:!0}),Object.defineProperty(e,"displayOriginalCurve",{get:function(){return w},enumerable:!0,configurable:!0}),Object.defineProperty(e,"order",{get:function(){return M},enumerable:!0,configurable:!0}),Object.defineProperty(e,"integrationPrecision",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"curvePrecision",{get:function(){return.5},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clearObservers",{get:function(){return b.clear},enumerable:!0,configurable:!0}),Object.defineProperty(e,"redrawObservers",{get:function(){return b.redraw},enumerable:!0,configurable:!0}),Object.defineProperty(e,"speedChangeObservers",{get:function(){return b.speedChange},enumerable:!0,configurable:!0}),Object.defineProperty(e,"presetObservers",{get:function(){return b.presetChange},enumerable:!0,configurable:!0}),e}();t.Parameters=j},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=!0;t.setEnabled=function(e){n=e},t.message=function(e){n&&console.log(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.start=performance.now()}return Object.defineProperty(e.prototype,"milliseconds",{get:function(){return Math.ceil(performance.now()-this.start)},enumerable:!0,configurable:!0}),e}();t.StopWatch=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(5),a=r(0),o=r(8);!function(){var e=document.getElementById("canvas"),t=e.getContext("2d");t.lineWidth=1;var r=null,s=null,c=new n.Clock,u=!0;a.Parameters.clearObservers.push((function(){return u=!0}));var l=!0;a.Parameters.redrawObservers.push((function(){return l=!0}));var h=2e3;function f(){r=null,s=null;var e=Canvas.getSize();Canvas.showLoader(!0),o.Presets.getPreset(a.Parameters.preset,e,(function(e){r=new i.LineDrawing(e),s=r.computeFourierSeries(300),u=!0,c.reset(),Canvas.showLoader(!1)}))}a.Parameters.presetObservers.push(f),Canvas.Observers.canvasResize.push(f),f(),requestAnimationFrame((function n(){if(null!==r&&null!==s){var i=c.current/h,o=a.Parameters.closeLoop?1:r.originalPathLength;if((i=Math.min(i,o))>=o&&a.Parameters.repeat&&(u=!0),u&&(u=!1,c.reset(),s.resetCurve(),i=0,Canvas.setIndicatorText("fourier-order",a.Parameters.order.toLocaleString()),t.clearRect(0,0,e.width,e.height)),l){if(e.width===e.clientWidth&&e.height===e.clientHeight||(e.width=e.clientWidth,e.height=e.clientHeight),a.Parameters.persistence||t.clearRect(0,0,e.width,e.height),a.Parameters.displayOriginalCurve){t.strokeStyle="rgb(0,128,0)";var f=t.lineWidth;t.lineWidth=2,r.draw(t,i),t.lineWidth=f}a.Parameters.displayCircles&&(t.strokeStyle=a.Parameters.persistence?"rgba(255,255,255,0.01)":"rgba(255,255,255,0.3)",s.drawCircles(t,a.Parameters.order,i)),a.Parameters.displayCurve&&(t.strokeStyle="white",s.drawCurve(t,a.Parameters.order,i)),a.Parameters.displaySegments&&(t.strokeStyle=a.Parameters.persistence?"rgba(255,0,0,0.01)":"red",s.drawPathToPoint(t,a.Parameters.order,i))}l=i<o}requestAnimationFrame(n)}))}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){function e(){var e=this;this.speed=n.Parameters.speed,n.Parameters.speedChangeObservers.push((function(){return e.setSpeed(n.Parameters.speed)})),this.reset()}return e.prototype.reset=function(){this.lastCheckpoint=0,this.lastCheckpointReal=performance.now()},e.prototype.setSpeed=function(e){this.lastCheckpoint=this.current,this.lastCheckpointReal=performance.now(),this.speed=e},Object.defineProperty(e.prototype,"current",{get:function(){return this.lastCheckpoint+this.speed*(performance.now()-this.lastCheckpointReal)},enumerable:!0,configurable:!0}),e}();t.Clock=i},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=r(6),a=n(r(1)),o=r(0),s=r(7),c=r(2),u=function(){function e(e){this.points=e;for(var t=0,r=0;r<this.points.length-1;r++)t+=s.distance(this.points[r],this.points[r+1]);var n=t,i=this.points[0],a=this.points[this.points.length-1];s.equals(i,a)||(n+=s.distance(a,i),this.points.push({x:i.x,y:i.y})),this.pathLength=n,this.originalPathLength=t/n}return e.prototype.draw=function(e,t){e.beginPath(),e.moveTo(this.points[0].x,this.points[0].y);var r,n=t*this.pathLength,i=0;for(r=0;r<this.points.length-1;r++){var a=this.points[r],o=this.points[r+1],c=s.distance(a,o);if(!(i+c<n)){var u=(n-i)/c,l=s.interpolate(a,o,u);e.lineTo(l.x,l.y),i+=s.distance(a,l);break}i+=c,e.lineTo(o.x,o.y)}e.stroke(),e.closePath()},e.prototype.computeFourierSeries=function(e){for(var t=new c.StopWatch,r=Math.ceil(o.Parameters.integrationPrecision*this.pathLength),n=this.pathLength/r,u=1/r,l=[],h=0,f=0,p=0;p<r;p++)for(var d=(p+.5)*u,v=(p+.5)*n,b=f;b<this.points.length-1;b++){var g=this.points[b],m=this.points[b+1],y=s.distance(g,m);if(!(h+y<v)){var P=(v-h)/y,O=s.interpolate(g,m,P);l.push({x:O.x,y:O.y,two_pi_t:2*Math.PI*d});break}h+=y,f=b+1}for(var C=[],x=0;x<2*e+1;x++){var k=Math.floor((x+1)/2);x>0&&x%2==0&&(k*=-1);for(var w=0,M=0,j=0,_=l;j<_.length;j++){var S=_[j],L=k*S.two_pi_t,R=Math.cos(L),T=Math.sin(L);w+=u*(S.x*R+S.y*T),M+=u*(S.y*R-S.x*T)}C.push({magnitude:Math.sqrt(w*w+M*M),phase:Math.atan2(M,w),n:k})}return a.message("Computed "+e+" Fourier coefficient with "+r+" integration steps in "+t.milliseconds+" ms."),new i.FourierSeries(C,this.pathLength)},e}();t.LineDrawing=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=2*Math.PI,a=function(){function e(e,t){this.coefficients=e,this.partialCurve=[],this.curveStepSize=1/(n.Parameters.curvePrecision*t)}return e.prototype.resetCurve=function(){this.partialCurve=[]},e.prototype.drawCurve=function(e,t,r){t!==this.partialCurveOrder&&(this.partialCurveOrder=t,this.resetCurve());for(var n,i=r/this.curveStepSize,a=Math.floor(i),o=Math.ceil(i),s=this.partialCurve.length;s<=a;s++)n=this.computePoint(t,s*this.curveStepSize),this.partialCurve.push(n);e.beginPath(),e.moveTo(this.partialCurve[0].x,this.partialCurve[0].y);for(s=1;s<o;s++)e.lineTo(this.partialCurve[s].x,this.partialCurve[s].y);n=this.computePoint(t,r),e.lineTo(n.x,n.y),e.stroke(),e.closePath()},e.prototype.drawPathToPoint=function(e,t,r){var n=this.computeAmountOfCoefficients(t);if(!(n<=0)){var a=this.coefficients[0].magnitude*Math.cos(this.coefficients[0].phase),o=this.coefficients[0].magnitude*Math.sin(this.coefficients[0].phase),s=i*r;e.beginPath(),e.moveTo(a,o);for(var c=1;c<n;c++){var u=this.coefficients[c],l=s*u.n;a+=u.magnitude*Math.cos(l+u.phase),o+=u.magnitude*Math.sin(l+u.phase),e.lineTo(a,o)}e.stroke(),e.closePath()}},e.prototype.drawCircles=function(e,t,r){var n=this.computeAmountOfCoefficients(t);if(!(n<2))for(var a,o,s,c=i*r,u=0,l=0,h=0;h<n;h++){var f=this.coefficients[h];h>1&&(a=u,o=l,s=f.magnitude,e.beginPath(),e.arc(a,o,s,0,i),e.closePath(),e.stroke());var p=c*f.n;u+=f.magnitude*Math.cos(p+f.phase),l+=f.magnitude*Math.sin(p+f.phase)}},e.prototype.computePoint=function(e,t){for(var r=0,n=0,a=this.computeAmountOfCoefficients(e),o=0;o<a;o++){var s=this.coefficients[o],c=i*s.n*t;r+=s.magnitude*Math.cos(c+s.phase),n+=s.magnitude*Math.sin(c+s.phase)}return{x:r,y:n}},e.prototype.computeAmountOfCoefficients=function(e){return Math.min(this.coefficients.length,1+2*e)},e}();t.FourierSeries=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.interpolate=function(e,t,r){return{x:e.x*(1-r)+t.x*r,y:e.y*(1-r)+t.y*r}},t.distance=function(e,t){var r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)},t.equals=function(e,t){return e.x===t.x&&e.y===t.y}},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(r(1)),o=r(2);!function(e){e.ARLEQUIN="arlequin",e.BULL="bull",e.CAMEL="camel",e.DOG="dog",e.DOVE="dove",e.FLAMINGO="flamingo",e.HORSE="horse",e.MOUSE="mouse",e.WOMAN1="woman1",e.WOMAN2="woman2"}(i||(i={})),t.EPreset=i;var s=512,c=function(){function e(){}return e.getPreset=function(t,r,n){var i=new o.StopWatch,c=!1;function u(e){for(var o=Math.min(r[0]/s,r[1]/s),u=.5*(r[0]-s*o),l=.5*(r[1]-s*o),h=[],f=0,p=e;f<p.length;f++){var d=p[f];h.push({x:d.x*o+u,y:d.y*o+l})}c?a.message("Retrieved preset '"+t+"' from cache in "+i.milliseconds+" ms"):a.message("Downloaded preset '"+t+"' in "+i.milliseconds+" ms."),n(h)}if(void 0===e.cache)e.cache={};else if(void 0!==e.cache[t])return c=!0,void u(e.cache[t]);var l=new XMLHttpRequest;l.addEventListener("readystatechange",(function(){if(l.readyState===XMLHttpRequest.DONE&&200===l.status){var r=e.tryParsePointsArray(l.responseText);null!==r&&(e.cache[t]=r,u(e.cache[t]))}})),l.open("GET","resources/"+t+".txt"),l.send()},e.tryParsePointsArray=function(e){if(!e)return null;for(var t=new o.StopWatch,r=[],n=0,i=e.split("\n");n<i.length;n++){var s=i[n].split(" ");if(2!==s.length)return null;r.push({x:+s[0],y:+s[1]})}return r.length<=1?null:(a.message("Parsed preset in "+t.milliseconds+" ms."),r)},e}();t.Presets=c}]);
//# sourceMappingURL=main.min.js.map